<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://apis.google.com/js/api.js"></script>
  <link rel="stylesheet" href="calstyle.css" />
  <title>Derby Neck Library Calendar Project</title>
  <meta name="description"
    content="Developing an application to display a prettier calendar for the Derby Neck Library." />
</head>

<body>
  <h1 id="Header">Derby Neck Library Calendar Project</h1>
  <p>Jason taught me how to make changes. Thank you, Jason!<br><br>

  <div class="container col-sm-4 col-md-7 col-lg-4 mt-5">
    <div class="card">
      <h3 class="card-header" id="monthAndYear"></h3>
      <table class="table table-bordered table-responsive-sm" id="calendar">
        <thead>
          <tr>
            <th>Sun</th>
            <th>Mon</th>
            <th>Tue</th>
            <th>Wed</th>
            <th>Thu</th>
            <th>Fri</th>
            <th>Sat</th>
          </tr>
        </thead>

        <tbody id="calendar-body">

        </tbody>
      </table>

      <div class="form-inline">

        <button class="btn btn-outline-primary col-sm-6" id="today" onclick="goToToday(); populateGoogleCal()">Today</button>

        <button class="btn btn-outline-primary col-sm-6" id="previous" onclick="previous(); populateGoogleCal()">Previous</button>

        <button class="btn btn-outline-primary col-sm-6" id="next" onclick="next(); populateGoogleCal()">Next</button>
      </div>
      <br />
      <form class="form-inline">
        <label class="lead mr-2 ml-2" for="month">Jump To: </label>
        <select class="form-control col-sm-4" name="month" id="month" onchange="jump(); populateGoogleCal()">
          <option value=0>Jan</option>
          <option value=1>Feb</option>
          <option value=2>Mar</option>
          <option value=3>Apr</option>
          <option value=4>May</option>
          <option value=5>Jun</option>
          <option value=6>Jul</option>
          <option value=7>Aug</option>
          <option value=8>Sep</option>
          <option value=9>Oct</option>
          <option value=10>Nov</option>
          <option value=11>Dec</option>
        </select>


        <label for="year"></label><select class="form-control col-sm-4" name="year" id="year" onchange="jump(); populateGoogleCal()">
          <option value=2024>2024</option>
          <option value=2025>2025</option>
          <option value=2026>2026</option>
          <option value=2027>2027</option>
          <option value=2028>2028</option>
          <option value=2029>2029</option>
          <option value=2030>2030</option>
        </select>
      </form>
    </div>
  </div>
  <!--<button name="jump" onclick="jump()">Go</button>-->

  <script>
    // await --- before we can continue, we have to wait for the response from another computer/the server
    //res = response
    async function populateGoogleCal() {

      var selectMonth = document.getElementById("month");
      var selectYear = document.getElementById("year");

      try {
        //fetch --- go get something from another computer/the server
        //res is a constant NOT CONSTRUCT, after RESOLVING THE PROMISE using .then, we grab the JSON body and store it in res
        //? denotes query parameters, which are used to send data to the server. in this case, we are sending the month and year 
        // selected by the user to the server, so that the server can get the correct events from the Google Calendar API.
        // document.getElementById IS CLIENT SIDE 
        const res = await fetch(`/api/callinggoogle?month=${selectMonth.value}&year=${selectYear.value}`).then((response) => response.json());
        document.getElementById("rR").textContent = JSON.stringify(res);
      } catch (error) {
        console.error("Error fetching calendar data:", error);
        document.getElementById("rR").textContent = "Sorry, Sarah. You messed up! Error loading calendar: " + error.message;
      }
    }
    // Wait for DOM to be fully loaded before calling
    document.addEventListener("DOMContentLoaded", populateGoogleCal);

  </script>

  </p>
  <div id="rR"></div>
  <script src="calendarview.js"></script>
</body>

<body>

</body>

</html>